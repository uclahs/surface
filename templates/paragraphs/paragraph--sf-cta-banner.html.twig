{#
  Set variable to trigger renderign of content array. See article for details:
  https://www.previousnext.com.au/blog/ensuring-drupal-8-block-cache-tags-bubble-up-page
#}
{% set rendered_content = content|render %}

{# Set variable to get the site's base url. #}
{% set base_url = url('<front>')|render %}

{#
  Set variable for value of the link field url. Check whether the patterns for the Matterport
  and Qualtrics urls exist in the link url.  If they do, we add a css class to the component
  as well as create a variable for the path to the image that will be added to the component.
#}
{% set banner_url = content.field_sf_link.0['#url']|render %}
{% if 'https://my.matterport.com' in banner_url %}
  {% set banner_modifier = 'cta-banner--matterport' %}
  {% set banner_image = base_url ~ directory ~ '/dist/images/cta-matterport.png' %}
{% elseif 'https://uclahs.az1.qualtrics.com' in banner_url %}
  {% set banner_modifier = 'cta-banner--qualtrics' %}
  {% set banner_image = base_url ~ directory ~ '/dist/images/cta-qualtrics.png' %}
{% endif %}

{# Set variable for the CTA so it matches structure of button component. #}
{% set banner_cta = {
  'modifier': 'button button--secondary',
  'text': content.field_sf_link|render|trim is not empty ? content.field_sf_link.0['#title'],
  'url': banner_url,
} %}

{# Set variable for cta-banner title.  These are the properties of the heading component. #}
{% set banner_title = {
  modifier: 'cta-banner__heading',
  heading_level: 2,
  text: content.field_sf_title|render|trim is not empty ? content.field_sf_title|field_value,
  url: '',
} %}

{# Embedding cta-banner component and mapping its fields to Drupal's fields #}
{% include '@components/cta-banner/cta-banner.twig' with {
  'attributes': attributes,
  'modifier': banner_modifier,
  'heading': banner_title,
  'teaser': content.field_sf_teaser|render|trim is not empty ? content.field_sf_teaser|field_value,
  'cta': banner_cta,
  'image': banner_image,
} only %}
